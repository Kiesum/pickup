<%= form_for :event, url: events_path do |f| %>
  <p>
    <%= f.label :sport %><br>
    <%= f.select :sport, ['soccer', 'tennis', 'football', 'baseball']%>
  </p>

  <p>
    <%= f.label :description %><br>
    <%= f.text_area :description %>
  </p>

  <p>
    <%= f.label :date %><br>
    <%= f.date_field :date %>
  </p>

  <p>
    <%= f.label :start_time %><br>
    <%= f.time_field :start_time %>
  </p>

  <p>
    <%= f.label :end_time %><br>
    <%= f.time_field :end_time %>
  </p>
 
  <p>
    <%= f.label :min_num_players %><br>
    <%= f.number_field(:min_num_players, in: 1..50) %>
  </p>

  <p>
    <%= f.label :max_num_players %><br>
    <%= f.number_field(:max_num_players, in: 1..50) %>
  </p>
 
  <p>
    <%= f.submit %>
  </p>
<% end %>

<button type="button" id="submit-button">Send data</button>

<!DOCTYPE html>
<html>
  <head>
    <style>
       #map {
        width: 100%;
        height: 400px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
    
      function initMap() {
        var mapDiv = document.getElementById('map');
        var map = new google.maps.Map(mapDiv, {
            center: {lat: 44.540, lng: -78.546},
            zoom: 8
        });

        var marker;
        var latitude;
        var longitude;

        function placeMarker(location) {
          if ( marker ) {
            marker.setPosition(location);
          } else {
            marker = new google.maps.Marker({
              position: location,
              map: map
            });
          }

          latitude = location.lat();
          longitude = location.lng();
           
        }

        google.maps.event.addListener(map, 'click', function(event) {
          placeMarker(event.latLng);
        });

        $('#submit-button').on('click', function() {
          $ .ajax({
                url : "/events",
                type : "post",
                data : { latitude: latitude, longitude: longitude }
            });
        });

      }
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDq5MfneZn7AftwwvG7m4ifBf28uU5NXnk&callback=initMap">
    </script>
  </body>
</html>